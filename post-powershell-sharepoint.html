<!DOCTYPE html>
<html lang="es"> 
<head>
    <title>EAGA-IT-BLOG</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Blog IT EAGA">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
	<script defer src="assets/fontawesome/js/all.min.js"></script>
    
    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="assets/css/theme-3.css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/styles/monokai-sublime.min.css">
    
</head> 

<body>
    
    <header class="header text-center">	    
		<h1 class="blog-name pt-lg-4 mb-0"><a href="index.html">EAGA Blog</a></h1>
        
	    <nav class="navbar navbar-expand-lg navbar-dark" >
           
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
			</button>

			<div id="navigation" class="collapse navbar-collapse flex-column" >
				<div class="profile-section pt-3 pt-lg-0">
				    
				</div><!--//profile-section-->
				
				<ul class="navbar-nav flex-column text-left">
					<li class="nav-item active">
					    <a class="nav-link" href="index.html"><i class="fas fa-home fa-fw mr-2"></i>Inicio<span class="sr-only">(current)</span></a>
					</li>
					<li class="nav-item">
					    <a class="nav-link" href="about.html"><i class="fas fa-user fa-fw mr-2"></i>Sobre Mí</a>
					</li>
				</ul>
				
				<div class="my-2 my-md-3">
				    <a class="btn btn-primary" href="https://github.com/eaga/" target="_blank">Contácteme</a>	
				</div>
			</div>
		</nav>
    </header>
    
    <div class="main-wrapper">
	    
	    <article class="blog-post px-3 py-5 p-md-5">
		    <div class="container">
			    <header class="blog-post-header">
				    <h2 class="title mb-2">Power Shell  - Sharepoint Online</h2>
				    <div class="meta mb-3"><span class="date">21-02-2023</span></div>
			    </header>
			    
			    <div class="blog-post-body">
				    <figure class="blog-banner">
				        <a href="#"><img class="img-fluid" src="assets/images/blog/powershell/115804.png" alt="image"></a>
				    </figure>
					<p>Rápido y Ágil  un  buen  punto  de  partida</p>   
					<p>Después de  unos meses  de arduo  trabajo y  un poco  alejado  de mi  blog es hora  de volver al carril  y si rápido  y ágil son  el  punto de partida para todo proceso de innovación tecnológica  y  aunque  este post sea corto nace de este proceso de innovación y una experiencia donde tuve que enfrentar una perdida de datos  y  su  restauración oportuna  y eficiente </p> 
					<p>En este apartado veremos los  siguientes puntos:</p>
					<ul class="mb-5">
					  <li class="mb-2">Que es PowerShell y Sharepoint </li>
					  <li class="mb-2">Que es PnP PowerShell</li>
					</ul>
					<h3 class="mt-5 mb-3">Que es PowerShell</h3>
					<figure class="blog-banner">
				        <a href="#"><img class="img-fluid" src="assets/images/blog/powershell/powershell-icon-14.jpg" alt="image"></a>
				    </figure>
				    <p>PowerShell es una solución de automatización de tareas multiplataforma formada por un shell de línea de comandos, un lenguaje de scripting y un marco de administración de configuración.</p> 
					<p>Con  base a  lo  anterior si  dirás se parece a la consola CMD  de MSDOS y la  respuesta  es si  pero  con un limitado numero de comandos  y esta  la  diferencia  de power shell. Con 
						Power Shell puedes  ejecutar un sin numero de scripts que  con  el  valor  principal  de la  colaboración  es cada dia mas infinitas las posibilidades que ofrece esta herramienta .  
					</p>
					<h3 class="mt-5 mb-3">Que es Sharepoint</h3>
					<figure class="blog-banner">
				        <a href="#"><img class="img-fluid" src="assets/images/blog/powershell/sharepoint.png" alt="image"></a>
				    </figure>
				    <p>es una plataforma de colaboración empresarial, formada por productos y elementos del  ecosistema Microsoft</p> 
					<h3 class="mt-5 mb-3">Que es PnP PowerShell</h3>
					<figure class="blog-banner">
				        <a href="#"><img class="img-fluid" src="assets/images/blog/powershell/pnp.png" alt="image"></a>
				    </figure>
				    <p>es un módulo de PowerShell multiplataforma que proporciona más de 600 cmdlets que funcionan con entornos de Microsoft 365 y, más específicamente, con SharePoint Online, Microsoft Teams, Microsoft Planner y Microsoft Flow</p> 
					<p>Con  base a  lo  anterior  hemos visto los  conceptos  básicos  necesarios para ejecutar la solución rápida para recuperar archivos borrados de algún sitio de sharepoint .  
					</p>	
					<p>Restaurar Papelera de reciclaje SharePoint Online con PowerShell:</p> 
						<ul class="mb-5"> 
							<li class="mb-2">Instalar el módulo PnP PowerShell .</li>
							<li class="mb-2">Conexión a SharePoint.</li> 
							<li class="mb-2">Script de Búsqueda y restauración .</li>
						</ul>
					<p> Para todo administrador  de plataformas  es vital que manejes con un mínimo la ejecución de comandos y scripts en powershell.
						Dentro  de  tu  consola PowerShell y con privilegios de administrador ejecuta  el siguiente comando  Install-Module SharePointPnPPowerShellOnline  este comando instalara los 
						componentes necesarios 
					</p>  

				    <p>Una Vez se complete la  instalación  es importante  tener claro  la definicion  del  siguiente  script:</p> 
					<p> $hoy=(Get-Date)
						$dia1 = $hoy.date.addDays(-1)
						$dia2 = $hoy.date.addDays(-3)  En  el  podemos  ver que primero  asigna a una variable  el  valor de la  fecha actual con  base  a  eso  podemos  observar  que la  linea dos  y tareas
					   serán las fechas  de búsqueda  el  desde y  hasta  </p>		
					
					<p></p>
					<p>
						Ahora  nuestro script de  búsqueda: </p> 
					<p>	
						<script> 
							Connect-PnPOnline https://contoso.sharepoint.com/sites/contoso

							Get-PnPRecycleBinItem -firststage | ? {($_.DeletedDate -gt $dia2 -and $_.DeletedDate -lt $dia1) -and ($_.DeletedByEmail -eq 'user@contoso.com')} | Export-Csv c:\temp\restore.csv
						</script>
					</p>
					
					<p></p>
					<p>Definiendo un poco la primera linea nos identifica  la  conexión con nuestro sharepoint,  luego una búsqueda  de la carpeta principal de papelera de reciclaje concatenamos el script para buscar
						todos aquellos archivos borrados entre un rango de fecha, seguido filtramos este conjunto de archivos con el  usuario quien elimino dichos archivos, una vez concatenamos para exportar nuestra búsqueda 
						en  un archivo mas manejable colocándole dirección y nombre. Ahora un  poco  de análisis  antes de  ejecutar nuestro  script de restauración 
					</p>
						

					 <p></p>

					<p>
						Ahora  nuestro script de restauracion: </p> 
					<p>	
					 <p>
						<script> 
							Connect-PnPOnline https://contoso.sharepoint.com/sites/contoso

							Get-PnPRecycleBinItem -firststage | ? {($_.DeletedDate -gt $dia2 -and $_.DeletedDate -lt $dia1) -and ($_.DeletedByEmail -eq 'user@contoso.com')} | ? LeafName -like '*.xlsm' | Restore-PnpRecycleBinItem -Force
						</script>
					</p>
						

					 <p></p>
					 <p>a diferencia  de nuestro  primer script es concatena un filtro de  tipo de  archivos y  el  comando  para  forzar  la  restauración de nuestros archivos  a  su  carpeta de origen</p>
						
						
					 
					<p>y es  asi  como  puedes  salir  de un  apuro  de restauración  de  archivos  borrados de  tu  sharepoint  que  estés  administrando  es importante mencionar  que este  conjunto de herramientas 
					  son eficientes  si  creas  correctamente  tus reglas de administración.

						En  una  próxima actualización agregaremos mas script en powershell que  te servirán  para administración diaria 
					</p>
					   
					
					
					
				    
					
				</div>	
				
				
			    

		    </div><!--//container-->
	    </article>
	    
	    
	    
	    <footer class="footer text-center py-2 theme-bg-dark">
		   
	        <!--/* This template is free as long as you keep the footer attribution link. If you'd like to use the template without the attribution link, you can buy the commercial license via our website: themes.3rdwavemedia.com Thank you for your support. :) */-->
            <small class="copyright">Designed with <i class="fas fa-heart" style="color: #fb866a;"></i> by <a href="http://themes.3rdwavemedia.com" target="_blank">Xiaoying Riley</a> for developers</small>
		   
	    </footer>
    
    </div><!--//main-wrapper-->

    <!-- Javascript -->          
    <script src="assets/plugins/jquery-3.4.1.min.js"></script>
    <script src="assets/plugins/popper.min.js"></script> 
    <script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script> 
    
    <!-- Page Specific JS -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.14.2/highlight.min.js"></script>

    <!-- Custom JS -->
    <script src="assets/js/blog.js"></script>
    
    <!-- Style Switcher (REMOVE ON YOUR PRODUCTION SITE) 
    <script src="assets/js/demo/style-switcher.js"></script>  -->      
    

</body>
</html> 

